<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guild Wars 2 Tracker - Home</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
    <!-- MenÃº Lateral -->
    <aside class="sidebar">
        <div class="logo">
            <h1>GW2 Tracker</h1>
        </div>
        <nav class="menu">
            <ul>
                <li><a href="index.html" class="active">Home</a></li>
                <li><a href="profit-calculator.html">Profit Calculator</a></li>
            </ul>
        </nav>
    </aside>

    <!-- Selector de Idioma -->
    <div class="language-button">
        <button class="menu-button">Language</button>
        <div class="dropdown-menu">
            <button class="menu-button" onclick="changeLanguage('en')">English</button>
            <button class="menu-button" onclick="changeLanguage('es')">EspaÃ±ol</button>
        </div>
    </div>

    <!-- Contenido Principal -->
    <main class="main-content">
        <section id="home" class="section">
            <h2 id="home-title">Item Tracker</h2>
            <table class="modern-table">
                <thead>
                    <tr>
                        <th id="item-name-header">Item</th>
                        <th id="buy-price-header">Buy Price</th>
                        <th id="sell-price-header">Sell Price</th>
                    </tr>
                </thead>
                <tbody id="home-table">
                    <!-- Filas generadas dinÃ¡micamente -->
                </tbody>
            </table>
        </section>
    </main>

    <script>
        let currentLanguage = 'en'; // Idioma por defecto
        const itemIds = [19684, 19702, 46738, 19721, 24277]; // IDs de los objetos

        function changeLanguage(lang) {
            currentLanguage = lang; // Cambia el idioma actual
            if (lang === 'en') {
                document.getElementById('home-title').innerText = 'Item Tracker';
                document.getElementById('item-name-header').innerText = 'Item';
                document.getElementById('buy-price-header').innerText = 'Buy Price';
                document.getElementById('sell-price-header').innerText = 'Sell Price';
            } else if (lang === 'es') {
                document.getElementById('home-title').innerText = 'Rastreador de Objetos';
                document.getElementById('item-name-header').innerText = 'Objeto';
                document.getElementById('buy-price-header').innerText = 'Precio de Compra';
                document.getElementById('sell-price-header').innerText = 'Precio de Venta';
            }
            fetchItemData(); // Recarga los datos con el idioma seleccionado
        }

        async function fetchItemData() {
            try {
                // Obtiene detalles de los objetos con el idioma seleccionado
                const itemDetails = await fetch(`https://api.guildwars2.com/v2/items?ids=${itemIds.join(",")}&lang=${currentLanguage}`);
                const items = await itemDetails.json();

                // Obtiene los precios actuales
                const itemPrices = await fetch(`https://api.guildwars2.com/v2/commerce/prices?ids=${itemIds.join(",")}`);
                const prices = await itemPrices.json();

                const tableBody = document.getElementById("home-table");
                tableBody.innerHTML = "";

                items.forEach(item => {
                    const price = prices.find(p => p.id === item.id);
                    if (!price) return;

                    const buyPrice = formatCurrency(price.buys.unit_price);
                    const sellPrice = formatCurrency(price.sells.unit_price);

                    const row = `
                        <tr>
                            <td>
                                <img src="${item.icon}" alt="${item.name}" class="item-icon">
                                <span>${item.name}</span>
                            </td>
                            <td>${buyPrice}</td>
                            <td>${sellPrice}</td>
                        </tr>
                    `;
                    tableBody.innerHTML += row;
                });
            } catch (error) {
                console.error("Error fetching data:", error);
            }
        }

        function formatCurrency(value) {
            const gold = Math.floor(value / 10000);
            const silver = Math.floor((value % 10000) / 100);
            const copper = value % 100;

            return `
                <span class="gold">${gold} ðŸŸ¡</span>
                <span class="silver">${silver.toString().padStart(2, "0")} âšª</span>
                <span class="copper">${copper.toString().padStart(2, "0")} ðŸŸ¤</span>
            `;
        }

        fetchItemData(); // Llama a la funciÃ³n al cargar la pÃ¡gina
    </script>
</body>
</html>